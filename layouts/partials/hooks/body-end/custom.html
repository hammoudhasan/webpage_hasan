<!-- Neural Frontier - Custom JavaScript -->
<script src="/js/neural-frontier.js" defer></script>

<!-- Background Texture Layer -->
<div id="bg-texture">
  <div id="bg-noise"></div>
  <div id="bg-glow"></div>
</div>
<style>
#bg-texture {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 1;
  pointer-events: none;
  overflow: hidden;
}

/* Noise grain texture - more visible */
#bg-noise {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  opacity: 0.08;
}

/* Neon glow spots - more visible */
#bg-glow {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background:
    radial-gradient(circle 600px at 0% 0%, rgba(0, 240, 255, 0.15) 0%, transparent 60%),
    radial-gradient(circle 500px at 100% 100%, rgba(191, 0, 255, 0.12) 0%, transparent 60%),
    radial-gradient(circle 400px at 80% 20%, rgba(0, 240, 255, 0.08) 0%, transparent 50%);
}

/* Additional CSS for scroll navbar */
.navbar.scroll-down {
  transform: translateY(-100%);
}
.navbar.scroll-up {
  transform: translateY(0);
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
}
</style>

<!-- Neural Network Intro Animation -->
<div id="neural-intro" class="neural-intro">
  <canvas id="neural-canvas"></canvas>
  <div class="intro-content">
    <div class="intro-logo">
      <svg class="brain-icon" viewBox="0 0 100 100" fill="none">
        <circle class="brain-circle" cx="50" cy="50" r="45" stroke="url(#neonGrad)" stroke-width="2"/>
        <circle class="brain-dot brain-dot-1" cx="30" cy="35" r="4" fill="#00f0ff"/>
        <circle class="brain-dot brain-dot-2" cx="70" cy="35" r="4" fill="#00f0ff"/>
        <circle class="brain-dot brain-dot-3" cx="50" cy="25" r="4" fill="#bf00ff"/>
        <circle class="brain-dot brain-dot-4" cx="35" cy="55" r="4" fill="#00f0ff"/>
        <circle class="brain-dot brain-dot-5" cx="65" cy="55" r="4" fill="#bf00ff"/>
        <circle class="brain-dot brain-dot-6" cx="50" cy="70" r="4" fill="#00f0ff"/>
        <line class="brain-line" x1="30" y1="35" x2="50" y2="25" stroke="#00f0ff" stroke-width="1.5"/>
        <line class="brain-line" x1="70" y1="35" x2="50" y2="25" stroke="#00f0ff" stroke-width="1.5"/>
        <line class="brain-line" x1="30" y1="35" x2="35" y2="55" stroke="#bf00ff" stroke-width="1.5"/>
        <line class="brain-line" x1="70" y1="35" x2="65" y2="55" stroke="#bf00ff" stroke-width="1.5"/>
        <line class="brain-line" x1="35" y1="55" x2="50" y2="70" stroke="#00f0ff" stroke-width="1.5"/>
        <line class="brain-line" x1="65" y1="55" x2="50" y2="70" stroke="#00f0ff" stroke-width="1.5"/>
        <line class="brain-line" x1="35" y1="55" x2="65" y2="55" stroke="#bf00ff" stroke-width="1.5"/>
        <defs>
          <linearGradient id="neonGrad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#00f0ff"/>
            <stop offset="100%" stop-color="#bf00ff"/>
          </linearGradient>
        </defs>
      </svg>
    </div>
    <div class="intro-terminal">
      <div class="terminal-line" data-delay="0">
        <span class="terminal-prompt">&gt;</span>
        <span class="terminal-text">Initializing neural network<span class="typing-dots">...</span></span>
      </div>
      <div class="terminal-line" data-delay="1500">
        <span class="terminal-prompt">&gt;</span>
        <span class="terminal-text">Loading research modules <span class="highlight">[LLM, Multimodal, Safety]</span></span>
      </div>
      <div class="terminal-line" data-delay="3500">
        <span class="terminal-prompt">&gt;</span>
        <span class="terminal-text">Connecting to <span class="highlight">KAUST Vision-Language Lab</span></span>
      </div>
      <div class="terminal-line" data-delay="5500">
        <span class="terminal-prompt">&gt;</span>
        <span class="terminal-text">Fetching publications <span class="highlight">[CVPR, NeurIPS, ICLR, ICML...]</span></span>
      </div>
      <div class="terminal-line" data-delay="7000">
        <span class="terminal-prompt">&gt;</span>
        <span class="terminal-text success">System ready. Welcome.</span>
      </div>
    </div>
    <div class="intro-name">HASAN HAMMOUD</div>
    <div class="intro-tagline">AI Researcher &bull; PhD @ KAUST</div>
    <div class="intro-progress">
      <div class="progress-bar"></div>
      <div class="progress-text">Loading<span class="loading-dots">...</span></div>
    </div>

    <!-- Scroll to enter prompt -->
    <div class="scroll-prompt" id="scroll-prompt">
      <span class="scroll-text">Scroll to enter</span>
      <div class="scroll-arrow">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 5v14M19 12l-7 7-7-7"/>
        </svg>
      </div>
    </div>
  </div>
</div>

<style>
/* Neural Intro Animation Styles */
.neural-intro {
  position: fixed;
  inset: 0;
  z-index: 99999;
  background: #000000;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.neural-intro.fade-out {
  animation: introFadeOut 1s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

@keyframes introFadeOut {
  0% { opacity: 1; transform: scale(1); }
  100% { opacity: 0; transform: scale(1.05); pointer-events: none; }
}

#neural-canvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
}

.intro-content {
  position: relative;
  z-index: 2;
  text-align: center;
  padding: 2rem;
}

/* Brain/Neural Logo */
.intro-logo {
  margin-bottom: 2.5rem;
}

.brain-icon {
  width: 140px;
  height: 140px;
  animation: floatBrain 4s ease-in-out infinite;
}

@keyframes floatBrain {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-15px); }
}

.brain-circle {
  stroke-dasharray: 283;
  stroke-dashoffset: 283;
  animation: drawCircle 2s ease forwards;
}

@keyframes drawCircle {
  to { stroke-dashoffset: 0; }
}

.brain-dot {
  opacity: 0;
  transform-origin: center;
}

.brain-dot-1 { animation: pulseDot 0.4s ease 0.5s forwards, glowPulse 2s ease 2s infinite; }
.brain-dot-2 { animation: pulseDot 0.4s ease 0.7s forwards, glowPulse 2s ease 2.2s infinite; }
.brain-dot-3 { animation: pulseDot 0.4s ease 0.9s forwards, glowPulse 2s ease 2.4s infinite; }
.brain-dot-4 { animation: pulseDot 0.4s ease 1.1s forwards, glowPulse 2s ease 2.1s infinite; }
.brain-dot-5 { animation: pulseDot 0.4s ease 1.3s forwards, glowPulse 2s ease 2.3s infinite; }
.brain-dot-6 { animation: pulseDot 0.4s ease 1.5s forwards, glowPulse 2s ease 2.5s infinite; }

@keyframes pulseDot {
  0% { opacity: 0; transform: scale(0); }
  50% { transform: scale(1.5); }
  100% { opacity: 1; transform: scale(1); }
}

@keyframes glowPulse {
  0%, 100% { filter: drop-shadow(0 0 3px currentColor); }
  50% { filter: drop-shadow(0 0 12px currentColor); }
}

.brain-line {
  stroke-dasharray: 50;
  stroke-dashoffset: 50;
  animation: drawLine 0.6s ease forwards;
  filter: drop-shadow(0 0 4px currentColor);
}

.brain-line:nth-child(7) { animation-delay: 0.6s; }
.brain-line:nth-child(8) { animation-delay: 0.8s; }
.brain-line:nth-child(9) { animation-delay: 1.0s; }
.brain-line:nth-child(10) { animation-delay: 1.2s; }
.brain-line:nth-child(11) { animation-delay: 1.4s; }
.brain-line:nth-child(12) { animation-delay: 1.6s; }
.brain-line:nth-child(13) { animation-delay: 1.8s; }

@keyframes drawLine {
  to { stroke-dashoffset: 0; }
}

/* Terminal Text */
.intro-terminal {
  font-family: 'Fira Code', 'SF Mono', 'Consolas', monospace;
  font-size: 0.9rem;
  text-align: left;
  max-width: 520px;
  margin: 0 auto 2.5rem;
  background: rgba(0, 240, 255, 0.02);
  border: 1px solid rgba(0, 240, 255, 0.15);
  border-radius: 8px;
  padding: 1.25rem 1.75rem;
}

.terminal-line {
  opacity: 0;
  transform: translateY(10px);
  margin-bottom: 0.6rem;
  color: #8892b0;
  display: flex;
  align-items: center;
}

.terminal-line:last-child {
  margin-bottom: 0;
}

.terminal-line.visible {
  animation: terminalReveal 0.5s ease forwards;
}

@keyframes terminalReveal {
  to { opacity: 1; transform: translateY(0); }
}

.terminal-prompt {
  color: #00f0ff;
  margin-right: 0.75rem;
  text-shadow: 0 0 10px rgba(0, 240, 255, 0.6);
  font-weight: bold;
}

.terminal-text .highlight {
  color: #bf00ff;
  text-shadow: 0 0 8px rgba(191, 0, 255, 0.4);
}

.terminal-text .success {
  color: #00ff88;
  text-shadow: 0 0 8px rgba(0, 255, 136, 0.4);
}

.typing-dots {
  animation: typingDots 1.5s infinite;
}

@keyframes typingDots {
  0%, 20% { opacity: 1; }
  40% { opacity: 0.3; }
  60% { opacity: 1; }
  80% { opacity: 0.3; }
  100% { opacity: 1; }
}

/* Name Reveal */
.intro-name {
  font-family: 'Orbitron', sans-serif;
  font-size: clamp(1.8rem, 6vw, 3.5rem);
  font-weight: 700;
  letter-spacing: 0.25em;
  background: linear-gradient(90deg, #00f0ff, #ffffff, #bf00ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  opacity: 0;
  transform: translateY(30px) scale(0.9);
  animation: nameReveal 1s ease 7.5s forwards;
  filter: drop-shadow(0 0 40px rgba(0, 240, 255, 0.4));
}

@keyframes nameReveal {
  to { opacity: 1; transform: translateY(0) scale(1); }
}

.intro-tagline {
  font-family: 'Rajdhani', sans-serif;
  font-size: 1.1rem;
  color: #8892b0;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  margin-top: 0.75rem;
  opacity: 0;
  animation: fadeUp 0.8s ease 8s forwards;
}

@keyframes fadeUp {
  to { opacity: 1; }
}

/* Progress Bar */
.intro-progress {
  width: 250px;
  margin: 2.5rem auto 0;
  position: relative;
}

.progress-bar {
  height: 3px;
  width: 0;
  background: linear-gradient(90deg, #00f0ff, #bf00ff);
  box-shadow: 0 0 20px rgba(0, 240, 255, 0.5);
  border-radius: 2px;
  animation: progressFill 8.5s ease-in-out forwards;
}

@keyframes progressFill {
  0% { width: 0; }
  10% { width: 10%; }
  25% { width: 30%; }
  40% { width: 50%; }
  60% { width: 70%; }
  80% { width: 90%; }
  100% { width: 100%; }
}

.progress-text {
  font-family: 'Fira Code', monospace;
  font-size: 0.75rem;
  color: #5a6380;
  margin-top: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.2em;
}

.loading-dots {
  animation: loadingDots 1.5s infinite;
}

@keyframes loadingDots {
  0%, 20% { content: '.'; }
  40% { content: '..'; }
  60%, 100% { content: '...'; }
}

/* Scroll Prompt */
.scroll-prompt {
  position: absolute;
  bottom: -120px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.75rem;
  opacity: 0;
  animation: scrollPromptAppear 1s ease 9s forwards;
  cursor: pointer;
}

.scroll-prompt.ready {
  animation: scrollPromptAppear 1s ease forwards, scrollPromptBounce 2s ease-in-out 1s infinite;
}

@keyframes scrollPromptAppear {
  to { opacity: 1; }
}

@keyframes scrollPromptBounce {
  0%, 100% { transform: translateX(-50%) translateY(0); }
  50% { transform: translateX(-50%) translateY(10px); }
}

.scroll-text {
  font-family: 'Orbitron', sans-serif;
  font-size: 0.8rem;
  color: #00f0ff;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  text-shadow: 0 0 15px rgba(0, 240, 255, 0.5);
}

.scroll-arrow {
  width: 28px;
  height: 28px;
  color: #00f0ff;
  filter: drop-shadow(0 0 10px rgba(0, 240, 255, 0.6));
  animation: arrowPulse 1.5s ease-in-out infinite;
}

@keyframes arrowPulse {
  0%, 100% { opacity: 1; transform: translateY(0); }
  50% { opacity: 0.5; transform: translateY(5px); }
}

/* Mobile adjustments */
@media (max-width: 480px) {
  .brain-icon {
    width: 100px;
    height: 100px;
  }
  .intro-terminal {
    font-size: 0.75rem;
    padding: 1rem 1.25rem;
    margin-bottom: 2rem;
  }
  .intro-name {
    letter-spacing: 0.15em;
  }
  .scroll-prompt {
    bottom: -100px;
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .neural-intro {
    display: none !important;
  }
}
</style>

<script>
(function() {
  // Check if intro was already shown this session
  if (sessionStorage.getItem('introShown')) {
    document.getElementById('neural-intro')?.remove();
    return;
  }

  const intro = document.getElementById('neural-intro');
  const canvas = document.getElementById('neural-canvas');
  const ctx = canvas.getContext('2d');
  const scrollPrompt = document.getElementById('scroll-prompt');

  // Prevent body scroll during intro
  document.body.style.overflow = 'hidden';

  // Resize canvas
  function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  resize();
  window.addEventListener('resize', resize);

  // Floating particles and connections
  const particles = [];
  const particleCount = 60;

  for (let i = 0; i < particleCount; i++) {
    particles.push({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height,
      vx: (Math.random() - 0.5) * 0.3,
      vy: (Math.random() - 0.5) * 0.3,
      size: Math.random() * 2 + 1,
      color: Math.random() > 0.5 ? '#00f0ff' : '#bf00ff'
    });
  }

  let animationRunning = true;

  function drawParticles() {
    if (!animationRunning) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Draw connections
    particles.forEach((p, i) => {
      for (let j = i + 1; j < particles.length; j++) {
        const p2 = particles[j];
        const dx = p2.x - p.x;
        const dy = p2.y - p.y;
        const dist = Math.sqrt(dx * dx + dy * dy);

        if (dist < 120) {
          ctx.beginPath();
          ctx.moveTo(p.x, p.y);
          ctx.lineTo(p2.x, p2.y);
          ctx.strokeStyle = `rgba(0, 240, 255, ${0.12 * (1 - dist / 120)})`;
          ctx.lineWidth = 0.5;
          ctx.stroke();
        }
      }
    });

    // Draw and move particles
    particles.forEach(p => {
      p.x += p.vx;
      p.y += p.vy;

      if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
      if (p.y < 0 || p.y > canvas.height) p.vy *= -1;

      ctx.beginPath();
      ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
      ctx.fillStyle = p.color;
      ctx.globalAlpha = 0.5;
      ctx.fill();
      ctx.globalAlpha = 1;
    });

    requestAnimationFrame(drawParticles);
  }

  drawParticles();

  // Terminal text animation
  const terminalLines = document.querySelectorAll('.terminal-line');
  terminalLines.forEach(line => {
    const delay = parseInt(line.dataset.delay);
    setTimeout(() => {
      line.classList.add('visible');
    }, delay);
  });

  // Function to dismiss intro
  function dismissIntro() {
    if (intro.classList.contains('fade-out')) return;

    animationRunning = false;
    intro.classList.add('fade-out');
    document.body.style.overflow = '';
    sessionStorage.setItem('introShown', 'true');

    setTimeout(() => {
      intro.remove();
    }, 1000);
  }

  // Enable scroll prompt after 9 seconds
  let canDismiss = false;
  setTimeout(() => {
    canDismiss = true;
    scrollPrompt.classList.add('ready');
  }, 9000);

  // Scroll to dismiss
  let scrollAccumulator = 0;
  window.addEventListener('wheel', (e) => {
    if (!canDismiss) return;
    scrollAccumulator += Math.abs(e.deltaY);
    if (scrollAccumulator > 100) {
      dismissIntro();
    }
  }, { passive: true });

  // Touch swipe to dismiss
  let touchStartY = 0;
  window.addEventListener('touchstart', (e) => {
    touchStartY = e.touches[0].clientY;
  }, { passive: true });

  window.addEventListener('touchmove', (e) => {
    if (!canDismiss) return;
    const touchY = e.touches[0].clientY;
    if (touchStartY - touchY > 50) {
      dismissIntro();
    }
  }, { passive: true });

  // Click on scroll prompt to dismiss
  scrollPrompt.addEventListener('click', () => {
    if (canDismiss) dismissIntro();
  });

  // Fallback: auto-dismiss after 12 seconds if user doesn't scroll
  setTimeout(() => {
    dismissIntro();
  }, 12000);
})();
</script>
